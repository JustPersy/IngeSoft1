<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import javafx.scene.shape.*?>

<AnchorPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.scalia.controllers.TunerController">

   <children>
      <BorderPane AnchorPane.topAnchor="0" AnchorPane.bottomAnchor="0"
                  AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0">
         
         <!-- Header -->
         <top>
            <VBox spacing="15" styleClass="header-section">
               <padding>
                  <Insets top="20" bottom="20" left="20" right="20"/>
               </padding>
               
               <HBox alignment="CENTER_LEFT" spacing="20">
                  <Button fx:id="backButton" text="← Volver" onAction="#goBack" styleClass="back-button"/>
                  <Text styleClass="page-title" text="🎧 Afinador">
                     <font>
                        <Font size="24"/>
                     </font>
                  </Text>
               </HBox>
               
               <HBox alignment="CENTER_LEFT" spacing="20">
                  <Label text="Instrumento:"/>
                  <ComboBox fx:id="instrumentComboBox" prefWidth="180"/>
                  <Label text="Afinación:"/>
                  <ComboBox fx:id="tuningPresetComboBox" prefWidth="200"/>
               </HBox>
               
               <HBox alignment="CENTER" spacing="20">
                  <Button fx:id="startTuningButton" text="🎵 Iniciar Afinación" onAction="#startTuning" styleClass="start-button"/>
                  <Button fx:id="stopTuningButton" text="⏹ Detener" onAction="#stopTuning" styleClass="stop-button"/>
               </HBox>
            </VBox>
         </top>
         
         <!-- Main content -->
         <center>
            <HBox spacing="20">
               <padding>
                  <Insets top="10" bottom="20" left="20" right="20"/>
               </padding>
               
               <!-- Left panel - Tuning notes -->
               <VBox spacing="10" prefWidth="200" minWidth="200">
                  <Label text="Notas de Afinación:" styleClass="section-title"/>
                  <ListView fx:id="tuningNotesListView" 
                          prefHeight="300" 
                          onMouseClicked="#selectNote"
                          styleClass="tuning-notes-list"/>
               </VBox>
               
               <!-- Center panel - Tuner display -->
               <VBox spacing="20" alignment="CENTER" HBox.hgrow="ALWAYS">
                  <VBox fx:id="tuningContainer" spacing="15" alignment="CENTER" styleClass="tuning-display">
                     
                     <!-- Current note display -->
                     <VBox spacing="10" alignment="CENTER">
                        <Label text="Nota Detectada:" styleClass="tuner-label"/>
                        <Label fx:id="currentNoteLabel" text="---" styleClass="current-note">
                           <font>
                              <Font size="48" style="-fx-font-weight: bold"/>
                           </font>
                        </Label>
                        <Label fx:id="frequencyLabel" text="--- Hz" styleClass="frequency-label">
                           <font>
                              <Font size="16"/>
                           </font>
                        </Label>
                     </VBox>
                     
                     <!-- Tuning indicator -->
                     <VBox spacing="10" alignment="CENTER">
                        <Circle fx:id="tuningIndicator" radius="40" styleClass="tuning-indicator tuning-neutral"/>
                        <ProgressBar fx:id="tuningProgressBar" prefWidth="300" progress="0.5" styleClass="tuning-progress"/>
                        <HBox spacing="20" alignment="CENTER">
                           <Label text="♭ Bajo" styleClass="tuning-low"/>
                           <Label text="Perfecto" styleClass="tuning-perfect"/>
                           <Label text="Alto ♯" styleClass="tuning-high"/>
                        </HBox>
                     </VBox>
                     
                     <!-- Target note -->
                     <VBox spacing="5" alignment="CENTER">
                        <Label fx:id="targetNoteLabel" text="Objetivo: ---" styleClass="target-note">
                           <font>
                              <Font size="18" style="-fx-font-weight: bold"/>
                           </font>
                        </Label>
                     </VBox>
                  </VBox>
                  
                  <!-- Status -->
                  <Label fx:id="statusLabel" text="Selecciona una afinación y presiona 'Iniciar Afinación'" 
                         styleClass="status-label" wrapText="true" textAlignment="CENTER"/>
               </VBox>
               
               <!-- Right panel - Instructions -->
               <VBox spacing="10" prefWidth="250" minWidth="250">
                  <Label text="Instrucciones:" styleClass="section-title"/>
                  <TextArea text="1. Selecciona tu instrumento y afinación

2. Presiona 'Iniciar Afinación'

3. Toca la cuerda que quieres afinar

4. Observa el indicador visual:
   • Rojo = Muy bajo
   • Verde = Perfecto
   • Azul = Muy alto

5. Ajusta la tensión de la cuerda hasta que el indicador esté verde

6. Repite para cada cuerda"
                        editable="false" 
                        wrapText="true"
                        prefRowCount="12"
                        styleClass="instructions-text"/>
               </VBox>
            </HBox>
         </center>
      </BorderPane>
   </children>
</AnchorPane>
